#!/bin/bash

set -euf -o pipefail

cid="$(ipfs add --only-hash --quieter "$1")"
key="$(ipfs cid format -b base16 -f "%D" "$cid")"
ecid="$(openssl enc -aes-256-cbc -in "$1" -K "$key" -iv "" | ipfs add --quieter)"

echo "$ecid#$cid"
